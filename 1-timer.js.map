{"version":3,"file":"1-timer.js","sources":["../src/js/1-timer.js"],"sourcesContent":["import flatpickr from \"flatpickr\";\nimport \"flatpickr/dist/flatpickr.min.css\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n/**\n * Глобальна змінна для зберігання обраної користувачем кінцевої дати.\n * @type {Date|null}\n */\nlet userSelectedDate = null;\n\n// --- Посилання на елементи DOM ---\nconst datetimePicker = document.querySelector('#datetime-picker');\nconst startButton = document.querySelector('[data-start]');\nconst timerFields = {\n    days: document.querySelector('[data-days]'),\n    hours: document.querySelector('[data-hours]'),\n    minutes: document.querySelector('[data-minutes]'),\n    seconds: document.querySelector('[data-seconds]'),\n};\n\n// Змінна для зберігання ID інтервалу таймера\nlet timerIntervalId = null;\n\n// --- 1. Функції-утиліти ---\n\n/**\n * Додає нуль попереду, якщо число менше 10.\n * @param {number} value\n * @returns {string} Відформатоване значення.\n */\nfunction addLeadingZero(value) {\n    return String(value).padStart(2, '0');\n}\n\n/**\n * Конвертує мілісекунди в об'єкт з днями, годинами, хвилинами та секундами.\n * @param {number} ms - Різниця в мілісекундах.\n * @returns {{days: number, hours: number, minutes: number, seconds: number}}\n */\nfunction convertMs(ms) {\n    const second = 1000;\n    const minute = second * 60;\n    const hour = minute * 60;\n    const day = hour * 24;\n\n    const days = Math.floor(ms / day);\n    const hours = Math.floor((ms % day) / hour);\n    const minutes = Math.floor(((ms % day) % hour) / minute);\n    const seconds = Math.floor((((ms % day) % hour) % minute) / second);\n\n    return { days, hours, minutes, seconds };\n}\n\n// --- 2. Об'єкт параметрів Flatpickr ---\nconst options = {\n    enableTime: true,\n    time_24hr: true,\n    defaultDate: new Date(),\n    minuteIncrement: 1,\n    onClose(selectedDates) {\n        const selectedDate = selectedDates[0];\n        const currentTime = Date.now();\n\n        if (selectedDate.getTime() < currentTime) {\n            // Дата в минулому\n            iziToast.error({\n                title: 'Помилка',\n                message: 'Please choose a date in the future',\n                position: 'topRight'\n            });\n            startButton.disabled = true;\n            userSelectedDate = null;\n        } else {\n            // Валідна дата в майбутньому\n            startButton.disabled = false;\n            userSelectedDate = selectedDate;\n        }\n    },\n};\n\n// Ініціалізація Flatpickr\nflatpickr(datetimePicker, options);\n\n\n// --- 3. Функції логіки таймера ---\n\n/**\n * Оновлює інтерфейс таймера відповідно до об'єкта часу.\n * @param {{days: number, hours: number, minutes: number, seconds: number}} time\n */\nfunction updateTimerDisplay({ days, hours, minutes, seconds }) {\n    timerFields.days.textContent = addLeadingZero(days);\n    timerFields.hours.textContent = addLeadingZero(hours);\n    timerFields.minutes.textContent = addLeadingZero(minutes);\n    timerFields.seconds.textContent = addLeadingZero(seconds);\n}\n\n/**\n * Зупиняє таймер і розблоковує поле вибору дати.\n */\nfunction stopTimer() {\n    clearInterval(timerIntervalId);\n    timerIntervalId = null;\n    datetimePicker.disabled = false;\n    startButton.disabled = true; // Кнопка залишається неактивною після зупинки\n    \n    // Повідомлення про завершення\n    iziToast.success({\n        title: 'Завершено!',\n        message: 'Countdown has finished.',\n        position: 'bottomRight'\n    });\n}\n\n/**\n * Запускає зворотний відлік.\n */\nfunction startCountdown() {\n    if (!userSelectedDate || timerIntervalId) return;\n\n    // Блокування інтерфейсу\n    startButton.disabled = true;\n    datetimePicker.disabled = true;\n\n    // Встановлення інтервалу\n    timerIntervalId = setInterval(() => {\n        const msRemaining = userSelectedDate.getTime() - Date.now();\n\n        if (msRemaining <= 0) {\n            // Час вичерпано\n            stopTimer();\n            // Встановлюємо нулі, якщо таймер зупинився\n            updateTimerDisplay({ days: 0, hours: 0, minutes: 0, seconds: 0 });\n            return;\n        }\n\n        // Обчислення та оновлення інтерфейсу\n        const time = convertMs(msRemaining);\n        updateTimerDisplay(time);\n\n    }, 1000);\n}\n\n// --- 4. Обробник події кліку на кнопку Start ---\nstartButton.addEventListener('click', startCountdown);"],"names":["userSelectedDate","datetimePicker","startButton","timerFields","timerIntervalId","addLeadingZero","value","convertMs","ms","days","hours","minutes","seconds","options","selectedDates","selectedDate","currentTime","iziToast","flatpickr","updateTimerDisplay","stopTimer","startCountdown","msRemaining","time"],"mappings":"+IAUA,IAAIA,EAAmB,KAGvB,MAAMC,EAAiB,SAAS,cAAc,kBAAkB,EAC1DC,EAAc,SAAS,cAAc,cAAc,EACnDC,EAAc,CAChB,KAAM,SAAS,cAAc,aAAa,EAC1C,MAAO,SAAS,cAAc,cAAc,EAC5C,QAAS,SAAS,cAAc,gBAAgB,EAChD,QAAS,SAAS,cAAc,gBAAgB,CACpD,EAGA,IAAIC,EAAkB,KAStB,SAASC,EAAeC,EAAO,CAC3B,OAAO,OAAOA,CAAK,EAAE,SAAS,EAAG,GAAG,CACxC,CAOA,SAASC,EAAUC,EAAI,CAMnB,MAAMC,EAAO,KAAK,MAAMD,EAAK,KAAG,EAC1BE,EAAQ,KAAK,MAAOF,EAAK,MAAO,IAAI,EACpCG,EAAU,KAAK,MAAQH,EAAK,MAAO,KAAQ,GAAM,EACjDI,EAAU,KAAK,MAASJ,EAAK,MAAO,KAAQ,IAAU,GAAM,EAElE,MAAO,CAAE,KAAAC,EAAM,MAAAC,EAAO,QAAAC,EAAS,QAAAC,CAAO,CAC1C,CAGA,MAAMC,EAAU,CACZ,WAAY,GACZ,UAAW,GACX,YAAa,IAAI,KACjB,gBAAiB,EACjB,QAAQC,EAAe,CACnB,MAAMC,EAAeD,EAAc,CAAC,EAC9BE,EAAc,KAAK,MAErBD,EAAa,QAAS,EAAGC,GAEzBC,EAAS,MAAM,CACX,MAAO,UACP,QAAS,qCACT,SAAU,UAC1B,CAAa,EACDf,EAAY,SAAW,GACvBF,EAAmB,OAGnBE,EAAY,SAAW,GACvBF,EAAmBe,EAE1B,CACL,EAGAG,EAAUjB,EAAgBY,CAAO,EASjC,SAASM,EAAmB,CAAE,KAAAV,EAAM,MAAAC,EAAO,QAAAC,EAAS,QAAAC,CAAO,EAAI,CAC3DT,EAAY,KAAK,YAAcE,EAAeI,CAAI,EAClDN,EAAY,MAAM,YAAcE,EAAeK,CAAK,EACpDP,EAAY,QAAQ,YAAcE,EAAeM,CAAO,EACxDR,EAAY,QAAQ,YAAcE,EAAeO,CAAO,CAC5D,CAKA,SAASQ,GAAY,CACjB,cAAchB,CAAe,EAC7BA,EAAkB,KAClBH,EAAe,SAAW,GAC1BC,EAAY,SAAW,GAGvBe,EAAS,QAAQ,CACb,MAAO,aACP,QAAS,0BACT,SAAU,aAClB,CAAK,CACL,CAKA,SAASI,GAAiB,CAClB,CAACrB,GAAoBI,IAGzBF,EAAY,SAAW,GACvBD,EAAe,SAAW,GAG1BG,EAAkB,YAAY,IAAM,CAChC,MAAMkB,EAActB,EAAiB,QAAS,EAAG,KAAK,IAAG,EAEzD,GAAIsB,GAAe,EAAG,CAElBF,IAEAD,EAAmB,CAAE,KAAM,EAAG,MAAO,EAAG,QAAS,EAAG,QAAS,CAAC,CAAE,EAChE,MACH,CAGD,MAAMI,EAAOhB,EAAUe,CAAW,EAClCH,EAAmBI,CAAI,CAE1B,EAAE,GAAI,EACX,CAGArB,EAAY,iBAAiB,QAASmB,CAAc"}